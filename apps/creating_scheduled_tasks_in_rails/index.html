<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://help.ninefold.com/apps/creating_scheduled_tasks_in_rails/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

        <title>Creating scheduled tasks in Rails - Ninefold</title>

        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/prettify-1.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        

        <script type="text/javascript">
        var __lc = {};
        __lc.license = 1076997;

        (function() {
            var lc = document.createElement('script'); lc.type = 'text/javascript'; lc.async = true;
            lc.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'cdn.livechatinc.com/tracking.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(lc, s);
        })();
        </script>
        
    </head>

    <body>

        <div id="ninefold-nav" class="navbar navbar-inverse " role="navigation">
    <div class="container">
        <div class="ninefold-nav">
            <div class="navbar-header">
                <a title="Ninefold" class="mast__topbar__logo logo" href="/"></a>
              
                
           
            </div>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".nine-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="collapse nine-navbar-collapse navbar-collapse">
                <ul class="nav navbar-nav">
                <li>
                  <a href="https://ninefold.com/pricing">Pricing</a>
                </li>
                <li>
                  <a href="https://ninefold.com/performance">Performance</a>
                </li>
                <li>
                  <a href="https://ninefold.com/testimonials">Testimonials</a>
                </li>
                <li>
                  <a href="https://ninefold.com/news">News</a>
                </li>
                <li>
                  <a href="https://ninefold.com/blog">Blog</a>
                </li>
                <li>
                  <a href="https://ninefold.com/about-us">About Us</a>
                </li>
                <li class="active">
                  <a href="https://help.ninefold.com">Docs</a>
                </li>
                <li class="signin">
                  <a href="http://portal.ninefold.com">Sign in</a>
                </li>
                </ul>
            </div>

        </div>
    </div>

</div>
<div class="main-nav">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".main-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <i class="fa fa-chevron-down"></i>
            </button>

            <!-- Main title -->
            <!-- <a class="navbar-brand" href="../..">Ninefold</a> -->
        </div>

        <!-- Expanded navigation -->
        <div class="main-navbar-collapse navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting Started <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../getstarted/how_to_deploy_an_app/">How to deploy an app</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_to_install_and_utilize_the_cli/">How to install and utilize the CLI</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_to_migrate_from_heroku/">How to migrate from Heroku</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_ninefold_works_with_github_bitbucket_and_git_url/">How Ninefold works with GitHub, Bitbucket and Git URL</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/exporting_and_importing_postgresql_data/">Exporting and importing PostgreSQL data</a>
                        </li>
                    
                        <li >
                            <a href="../../getstarted/how_to_deploy_diaspora/">How to deploy Diaspora on Ninefold</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">App Deployment <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../deployment_with_continuous_integration_ci/">Deployment with continuous integration (CI)</a>
                        </li>
                    
                        <li >
                            <a href="../deploying_a_rails_app_with_your_own_database/">Deploying a Rails app with your own database</a>
                        </li>
                    
                        <li >
                            <a href="../asset_precompile_on_ninefold/">Asset precompilation on Ninefold</a>
                        </li>
                    
                        <li >
                            <a href="../setting_up_deployment_notifications/">Setting up deployment notifications</a>
                        </li>
                    
                        <li >
                            <a href="../zero_downtime_deployment_for_your_ninefold_rails_app/">Zero downtime deployment for your Rails app</a>
                        </li>
                    
                        <li >
                            <a href="../Setting_and_changing_your_apps_configuration_and_infrastructure/">Setting and changing your app configuration and infrastructure</a>
                        </li>
                    
                        <li >
                            <a href="../private_gem_repos_on_github_&_bitbucket/">Private gem repos on GitHub and Bitbucket</a>
                        </li>
                    
                        <li >
                            <a href="../what_happens_and_what_gets_built_on_a_rails_app_deployment/">What happens and what gets built when you deploy your app</a>
                        </li>
                    
                        <li >
                            <a href="../ssl_management_for_rails_apps/">SSL for Rails apps</a>
                        </li>
                    
                        <li >
                            <a href="../dns_management_for_rails_apps/">DNS management for Rails apps</a>
                        </li>
                    
                        <li >
                            <a href="../adding_sendgrid_to_your_rails_app/">Adding SendGrid to your Rails app</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Creating scheduled tasks in Rails</a>
                        </li>
                    
                        <li >
                            <a href="../backing_up_and_restoring_your_rails_db/">Backing up and restoring your database</a>
                        </li>
                    
                        <li >
                            <a href="../redeploying_an_app/">Redeploying an app</a>
                        </li>
                    
                        <li >
                            <a href="../postgres_and_postgis_and_modules/">PostgreSQL, PostGIS, and PostgreSQL modules</a>
                        </li>
                    
                        <li >
                            <a href="../how_to_utilize_a_cdn_with_ninefold/">How to utilize a CDN with Ninefold (S3 and CloudFront)</a>
                        </li>
                    
                        <li >
                            <a href="../upgrading_from_rails_40_to_41/">Upgrading from Rails 4.0 to 4.1</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Servers <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../servers/how_to_create_a_docker_server/">Docker containers</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/create/">How to create a server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/resize/">How to resize your server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/liveview/">How to access your server with live view</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_clone_your_server/">How to clone a server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_attach_and_upload_an_iso/">How to upload and attach an ISO</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_create_a_template_from_your_server/">How to create a template from your server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/moving/">Copying or moving servers between regions</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_add_storage_volumes/">How to add storage volumes</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_view_attached_and_detached_storage_volumes/">How to view attached and detached storage volumes</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_detach_then_reattach_a_storage_volume/">How to detach then reattach a storage volume</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/using_backups_to_protect_your_data/">Using backups to protect your data</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/new_server_username_and_password/">New server username and password</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/resetting_server_password/">Reset your server password</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_connect_to_your_server_using_ssh_rdp/">How to connect to your server using SSH / RDP</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/how_to_activate_windows_server/">How to activate Windows Server</a>
                        </li>
                    
                        <li >
                            <a href="../../servers/microsoft_licensing_can_i_use_my_existing_software_and_licenses_on_ninefold/">Microsoft licensing - Can I use my existing software and licenses?</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Networking <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../networking/ninefold_net/">How to enable Ninefold Net</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/dns_management_for_servers/">DNS management for servers</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/setup_load_balancing_single_zone/">Setup load balancing (single zone)</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/setting_up_static_nat_&_port_forward_for_ip_addresses/">Setting up static NAT & port forward for IP addresses</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_open_firewall_ports/">How to open firewall ports</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_setup_global_load_balancing_for_servers/">How to setup global load balancing for servers</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_delegate_your_domain_to_ninefold/">How to delegate your domain to Ninefold</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_release_or_unassign_your_ip_addresses/">How to release or unassign your IP addresses</a>
                        </li>
                    
                        <li >
                            <a href="../../networking/how_to_use_multiple_ip_addresses_on_a_server/">How to use multiple IP addresses on a server</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Accounts & Billing <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../billing/freetrial/">Free trial</a>
                        </li>
                    
                        <li >
                            <a href="../../billing/createuser/">Creating additional users</a>
                        </li>
                    
                        <li >
                            <a href="../../billing/closeaccount/">How to close your account</a>
                        </li>
                    
                        <li >
                            <a href="../../billing/faq/">Billing FAQ</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../reference/faq/">FAQ</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/apdex/">Apdex to measure user satisfaction</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/API/">Using the API (v2)</a>
                        </li>
                    
                        <li >
                            <a href="../../reference/contributing/">Contribute to our docs</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <!-- 
                <li>
                    <a href="https://github.com/ninefold/docs/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                 -->
            </ul>
        </div>
    </div>
</div>

        <div class="container-fluid">
         
            <div class="col-md-3"><div class="bs-sidebar hidden-print hidden-xs hidden-sm affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#creating-scheduled-tasks-in-rails">Creating Scheduled Tasks in Rails</a></li>
    
    </ul>
</div>
</div>

            <div class="col-md-9" role="main">

                <div class="col-md-12 hidden-xs hidden-sm">
                    <a href="https://github.com/ninefold/docs/tree/master/docs/apps/creating_scheduled_tasks_in_rails.md" class="github-btn btn btn-default pull-right"> <span class="fa fa-github"></span> Edit on GitHub</a>
                </div>
                <div class="col-md-12 hidden-xs hidden-sm"></br></div>
                
                   

<h2 id="creating-scheduled-tasks-in-rails">Creating Scheduled Tasks in Rails</h2>
<h4 id="scheduling">Scheduling</h4>
<p>Maybe you’ve got some rake tasks that need to be run every morning. Or maybe you’ve got source some data from an external web service and load it into a your database. Whatever task it is, it’s got to be on a schedule. It’s pretty easy to do with Ninefold.</p>
<p>So the popular way to do this is to schedule a ‘cron’ job to run your commands using the ‘Whenever’ gem. Here’s how.</p>
<h4 id="install-the-whenever-gem">Install the Whenever gem</h4>
<p>Add the whenever gem to your Gemfile:</p>
<pre class="prettyprint well"><code>gem 'whenever', :require =&gt; false
</code></pre>
<p>Then install the gem in your local environment:</p>
<pre class="prettyprint well"><code>$ bundle install
</code></pre>
<h4 id="create-a-config-file">Create a config file</h4>
<p>Create your initial config file in your app:</p>
<pre class="prettyprint well"><code>$ cd /rails_apps/my_awesome_app
$ wheneverize .
</code></pre>
<p>This will create <code>config/schedule.rb</code> which gives some examples to use. Type your cron tasks in <code>config/schedule.rb</code>. For examples of some cron schedules, go here: <a href="https://www.github.com/javan/whenever">Whenever gem</a></p>
<h4 id="set-up-custom-post_migration-trigger-on-ninefold">Set up custom post_migration trigger on Ninefold</h4>
<p>In your Ninefold app, go to the <strong>Configuration</strong> tab &gt; <strong>Deployment Triggers</strong>, in the <em>After Migrations</em> section type:</p>
<pre class="prettyprint well"><code>$ bundle exec whenever --update-crontab my_awesome_app
</code></pre>
<p>Where <code>my_awesome_app</code> is what you'd like to name your cron task. Press <em>Update triggers</em> to save.</p>
<h4 id="commit-your-changes-to-run-the-triggers">Commit your changes to run the triggers</h4>
<pre class="prettyprint well"><code>$ git add .
$ git commit -m "Adding cron jobs using whenever"
$ git push origin my_ninefold_deploy_branch
</code></pre>
<p><em>Note: You've got to update your triggers first before you commit so that Ninefold can run them properly.</em></p>
<p>Cron tasks will be run from the root directory of your app. If you've got multiple web and worker servers, cron tasks currently will run on ALL your web and worker servers by default. If you would like to have the cron task run ONLY on certain servers, please submit a ticket, and we will provide you details on how to do this.</p>
<h4 id="adding-an-environment-variable-to-cron">Adding an environment variable to cron</h4>
<p>You can use defined environment variables in whenever gem constructed cron tasks. Simply add an env line for each of your environment vars in config/schedule.rb:</p>
<pre class="prettyprint well"><code>### schedule.rb
env :SAMPLE_VAR, ENV['SAMPLE_VAR']
env :ANOTHER_SAMPLE_VAR, ENV[‘ANOTHER_SAMPLE_VAR’]
env :MANUALLY_DEFINED_VAR, “This is a manually defined environment variable."
every 15.minutes do
  command "echo \"I am running from cron! Environment variable value: ${SAMPLE_VAR}\""
end
</code></pre>
<h4 id="logging-your-cron-jobs">Logging your cron jobs</h4>
<p>The whenever gem comes with the ability to set the output to a log file. To do this on Ninefold, add this to your config/schedule.rb file"."</p>
<pre class="prettyprint well"><code>set :output, '/var/www/apps/YOUR_APP_NAME/current/log/custom_deploy_after_migrate.log'
</code></pre>
<p>Where <code>YOUR_APP_NAME</code> is the git name of your app. This will allow for your output to be directed to the <em>After Migrations</em> trigger log, which is viewable in the CLI as well as in the <strong>Logs</strong> viewer (under Triggers).</p>
<p>For more information about output redirection with the whenever gem, <a href="https://github.com/javan/whenever/wiki/Output-redirection-aka-logging-your-cron-jobs">click here</a>.</p>
<p>If you have any questions regarding your cron tasks, please feel free to chat with us or submit a ticket!</p>

            </div>
        </div>

        

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script src="../../js/prettify-1.0.min.js"></script>

        <script src="../../js/base.js"></script>
    </body>
</html>